<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>RainCheck</title>
  <script>
    function updateActivityDetails() {
      const selectElement = document.getElementById("activity");
      const selectedOption = selectElement.options[selectElement.selectedIndex];
      const activityData = selectedOption.getAttribute('data-activity');

      if (activityData) {
        const selectedActivity = JSON.parse(activityData);

        document.getElementById("activityName").innerText = selectedActivity.name;
        document.getElementById("activityDescription").innerText = selectedActivity.description;
        document.getElementById("activityTemp").innerText = selectedActivity.temperature;
        document.getElementById("activityWindSpeed").innerText = selectedActivity.windSpeed;

        // Display conditions
        const conditions = selectedActivity.conditions.map(cond => cond.name).join(", ");
        document.getElementById("activityCond").innerText = conditions;

      } else {
        document.getElementById("activityName").innerText = '';
        document.getElementById("activityDescription").innerText = '';
        document.getElementById("activityTemp").innerText = '';
        document.getElementById("activityWindSpeed").innerText = '';
        document.getElementById("activityCond").innerText = '';
      }
    }
     // JavaScript function to change the saved icon and href based on the page title
        function updateSavedIcon() {
            var title = document.title; // Get the current page title

            var savedIcon = document.getElementById("icon-image");
            var savedLink = document.getElementById("icon-link"); // Get the anchor tag

            // Set the image source and href based on the title
            if (title === "RainCheck") {
                savedIcon.src = "https://i.ibb.co/rHXmBFs/list-icon.png";
                savedLink.href = "/activities";
            } else if (title === "RainCheck Activities") {
                savedIcon.src = "https://i.ibb.co/Qb9zzTY/back-arrow.png";
                savedLink.href = "/";
            } else {
                // Default case if title doesn't match expected values
                savedIcon.src = "https://i.ibb.co/rHXmBFs/list-icon.png";
                savedLink.href = "/";
            }
        }

        // Call the function once when the page loads
        window.onload = function() {
            updateSavedIcon();
        };
  </script>
</head>
<body>
<header th:replace="header :: body"></header>

<main>

  <div id="weather-block">
    <h2>Current Weather in Newcastle</h2>
    <div id="weather-icon">
      <img th:src="${weather_icon}" onerror="this.style.display = 'none';" alt="Weather Icon">
    </div>
    <div id="temp-wind">
      <p class="temp-wind-p"><span th:text="${weather.temperature}"></span> Â°C</p>
      <p class="temp-wind-p"><span th:text="${weather.wind_speed}"></span> mph</p>
    </div>
  </div>

  <div id="activity-block">
    <form action="#">
      <label for="activity">Today's Activity</label>
      <select name="activity" id="activity" onchange="updateActivityDetails()">
        <option value="0" disabled selected>Select Activity</option>
        <option th:each="activity : ${activities}"
                th:attr="data-activity=${activity.toJson()}"
                th:text="${activity.name}">
        </option>
        <option value="add-new">Add New</option>
      </select>
    </form>
    <h3>Activity Details</h3>
    <p>Name: <span id="activityName"></span></p>
    <p>Description: <span id="activityDescription"></span></p>
    <p>Ideal Temperature: <span id="activityTemp"></span></p>
    <p>Ideal Wind Speed: <span id="activityWindSpeed"></span></p>
    <p>Ideal Conditions: <span id="activityCond"></span></p>
  </div>

</main>

<footer th:replace="footer :: body"></footer>

</body>
</html>
